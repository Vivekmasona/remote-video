<!DOCTYPE html>
<html>
<head>
  <title>Radio</title>
</head>
<body>
  <h1>Live Radio Broadcast</h1>
  <audio id="audio" controls autoplay></audio>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io('http://your-server-ip:3000');
    const audio = document.getElementById('audio');
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioContext.createBufferSource();
    const scriptNode = audioContext.createScriptProcessor(4096, 1, 1);

    scriptNode.onaudioprocess = function(event) {
      const inputBuffer = event.inputBuffer;
      const outputBuffer = event.outputBuffer;
      for (let channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
        const inputData = inputBuffer.getChannelData(channel);
        const outputData = outputBuffer.getChannelData(channel);
        for (let sample = 0; sample < inputBuffer.length; sample++) {
          outputData[sample] = inputData[sample];
        }
      }
    };

    socket.on('audio', (data) => {
      const arrayBuffer = data.buffer;
      audioContext.decodeAudioData(arrayBuffer, (buffer) => {
        source.buffer = buffer;
        source.connect(audioContext.destination);
        source.start(0);
      });
    });

    source.connect(scriptNode);
    scriptNode.connect(audioContext.destination);
  </script>
</body>
</html>

