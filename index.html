<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Upload and Stream</title>
</head>
<body>
    <input type="file" id="audioFileInput">
    <button id="uploadButton">Upload</button>
    <audio id="audioPlayer" controls></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
    <script>
        const socket = io();
        const audioPlayer = document.getElementById('audioPlayer');
        const uploadButton = document.getElementById('uploadButton');
        const audioFileInput = document.getElementById('audioFileInput');

        uploadButton.addEventListener('click', () => {
            const file = audioFileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => {
                    const chunk = reader.result;
                    socket.emit('audioChunk', chunk);
                };
                reader.readAsArrayBuffer(file);
            }
        });

        // Receive audio chunks from server and play them
        socket.on('audioChunk', (chunk) => {
            audioPlayer.src = URL.createObjectURL(new Blob([chunk]));
            audioPlayer.play();
        });
    </script>
</body>
</html>
